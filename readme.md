# Project Setup

## Getting Started

1. **Create a Python Virtual Environment**
    - Run `python3 -m venv venv` to create a virtual environment named `venv`.
    - Activate the virtual environment:
        - Windows: `venv\Scripts\activate`
        - macOS/Linux: `source venv/bin/activate`

2. **Install Dependencies**
    - Run `pip install -r requirements.txt` to install the dependencies listed in `requirements.txt`.

3. **Install FFmpeg**
    - **Windows**:
        1. Download the FFmpeg build from [FFmpeg Official Site](https://ffmpeg.org/download.html).
        2. Extract the downloaded zip file.
        3. Add the path to the FFmpeg bin folder to the System's Environment Variables.
    - **macOS**: Run `brew install ffmpeg` if you have Homebrew installed.
    - **Linux**: Run `sudo apt-get install ffmpeg` for Debian-based distributions or the equivalent command for your distro.

4. **Start the Project**
    - Run `python simulate.py` to start the project.

5. **Handle Input**
    - When prompted `please input the minor cycle`, enter the duration of the minor cycle.
    - For `please input data cache mode when sensor cache is full. 1 for discarding oldest datum and 2 for stopping adding`, enter the cache full strategy.

6. **Output**
    - The result video file will be saved in the newly created path as `out.mp4`.

## Project Structure

1. **simulate.py**: The core file of this project, defining the cyclic scheduler, real-time drawing, and other related logic.
2. **utils.py**: Utility file containing singleton factory methods, environment initialization, and ffmpeg video synthesis methods.
3. **my_enum.py**: Enumeration file, where `SensorEnum` defines parameters for various sensors, `DiscardPolicy` enumerates cache full strategies, and `EventEnum` lists event tracing events.
4. **message.proto**: Defines the structure of the data transmission packet using protobuf3 syntax.
5. **message_pb.py**: Auto-generated by the protobuf tool based on `message.proto` for message serialization and deserialization.
6. **init_mysql.py**: Initializes MySQL and provides methods for writing event tracing (minor cycle execution timeout interruption and sensor cache overflow events).
7. **fair_lock.py**: Implementation of a fair lock.
8. **data_model.py**: Data model for event tracing.
9. **bounded_queue.py**: Provides an abstract class and two concrete classes implementing read-write separation secure bounded blocking queues based on double array switching.
10. **analysis.sql**: Contains SQL statements for analyzing experiment results.
11. **analysis.py**: Contains Python code for plotting experiment results based on SQL queries.
